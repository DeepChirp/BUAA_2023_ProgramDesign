# 魔法实验 4.0

时间限制：1000 ms / 空间限制：65536 KB / 难度：2

## 题目背景

在 Patchouli Knowledge 展示了火与水交融的魔法之后，Kirisame Marisa 仍不满足，想要见识一下更多元素和属性交织的魔法。Patchouli 表示 Marisa 的魔法水平还不足以掌握两种以上属性同时使用的魔法，便继续给她演示两种属性（火、水）魔法相互转换的实验。

## 题目描述

Patchouli 将火和水两种属性的水晶排成了 $n$ 行 $m$ 列的矩形法阵，她每次施展魔法，都可以产生如下两种效果中的一个：

+ 选定一行，将此行所有水晶的属性转换，即火变水，水变火；
+ 选定一列，将此列所有水晶的属性转换，效果同上。

以 `F` 表示火，`W` 代表水，则可以用 $n$ 个长度为 $m$ 且仅包含 `F` 与 `W` 的字符串表示初始时水晶法阵的状态。

Patchouli 希望通过有限次操作，将所有水晶变成同一种属性。 她有哮喘和贫血的毛病，不能长时间咏唱魔法，因此她希望在可能实现的情况下施展的魔法次数最少。她当然知道如何使用魔法，但她想考考 Marisa 对这个魔法的了解程度。

## 输入

多组数据输入。

第一行，一个整数 $T(1\leq T\leq 10)$，表示数据组数。

接下来对于每组数据：

第一行，两个整数 $n,m(1\leq n,m\leq 1000)$，表示水晶法阵的行数与列数，以一个空格分隔；

接下来 $n$ 行，每行一个长度为 $m$ 且只包含 `F` 与 `W` 的字符串，描述这个法阵。

## 输出

每组数据一行，对于题目描述中的魔法效果，如果可行则输出最少的魔法释放次数，否则输出 `mq~`。

## 样例

### 输入 #1

    1
    2 2
    FF
    FF

### 输出 #1

    0

### 输入 #2

    2
    2 3
    FWW
    FFW
    4 4
    FWFW
    WFWF
    FWFW
    WFWF

### 输出 #2

    mq~
    4
